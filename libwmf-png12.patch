diff -aurN libwmf-0.2.8.4.orig/configure.ac libwmf-0.2.8.4/configure.ac
--- libwmf-0.2.8.4.orig/configure.ac	2005-07-27 22:48:39.000000000 +0200
+++ libwmf-0.2.8.4/configure.ac	2006-07-12 21:05:54.101107895 +0200
@@ -520,12 +520,12 @@
 CPPFLAGS="$CPPFLAGS $WMF_Z_CFLAGS"
 
 AC_CHECK_HEADER(png.h,[
-	AC_CHECK_LIB(png,png_write_image,[
+	AC_CHECK_LIB(png14,png_write_image,[
 		if [ test "x$PNG_DIR" != "x" ]; then
 			WMF_PNG_CFLAGS="-I$PNG_DIR/include"
-			WMF_PNG_LDFLAGS="-L$PNG_DIR/lib -lpng"
+			WMF_PNG_LDFLAGS="-L$PNG_DIR/lib -lpng14"
 		else
-			WMF_PNG_LDFLAGS="-lpng"
+			WMF_PNG_LDFLAGS="-lpng14"
 		fi
 	],[	AC_MSG_ERROR(* * * unable to find libpng which is required by libwmf * * *)
 	],-lz -lm)
@@ -645,7 +645,7 @@
 
 	CPPFLAGS="$CPPFLAGS $WMF_FT_CFLAGS $WMF_PNG_CFLAGS $WMF_Z_CFLAGS"
 	LDFLAGS="$LDFLAGS $WMF_FT_LDFLAGS $WMF_PNG_LDFLAGS $WMF_Z_LDFLAGS"
-	other_libs="$other_libs -lfreetype -lpng -lz -lm"
+	other_libs="$other_libs -lfreetype -lpng14 -lz -lm"
 
 	AC_CHECK_HEADER(gd.h,[
 		AC_CHECK_LIB(gd,gdClipSetAdd,[
--- libwmf-0.2.8.4/src/extra/gd/gd_png.c	2005-07-27 22:35:06.000000000 +0200
+++ libwmf-0.2.8.4/src/extra/gd/gd_png.c.new	2010-01-28 18:47:25.381590959 +0100
@@ -136,7 +136,7 @@
   /* first do a quick check that the file really is a PNG image; could
    * have used slightly more general png_sig_cmp() function instead */
   gdGetBuf (sig, 8, infile);
-  if (!png_check_sig (sig, 8))
+  if (png_sig_cmp(sig, 0, 8) != 0)
     return NULL;		/* bad signature */
 
 #ifndef PNG_SETJMP_NOT_SUPPORTED
